<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Quad(ric) Function - RAYX Wiki</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../index.html">README</a></li><li class="chapter-item "><a href="../Introduction/01-Introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Introduction/02-How-to-build.html"><strong aria-hidden="true">1.1.</strong> How to Build</a></li><li class="chapter-item "><a href="../Introduction/02-How-to-install.html"><strong aria-hidden="true">1.2.</strong> How to Install</a></li><li class="chapter-item "><a href="../Introduction/03-Getting-Started.html"><strong aria-hidden="true">1.3.</strong> Getting Started</a></li><li class="chapter-item "><a href="../Introduction/04-How-to-use-rayx-ui.html"><strong aria-hidden="true">1.4.</strong> How to use RAYX-UI</a></li><li class="chapter-item "><a href="../Introduction/05-How-to-use-rayx.html"><strong aria-hidden="true">1.5.</strong> RAYX Commands</a></li><li class="chapter-item "><a href="../Introduction/06-Literature.html"><strong aria-hidden="true">1.6.</strong> Literature</a></li><li class="chapter-item "><a href="../Introduction/07-Style-Guide.html"><strong aria-hidden="true">1.7.</strong> Style Guide</a></li></ol></li><li class="chapter-item expanded "><a href="../Model/Model.html"><strong aria-hidden="true">2.</strong> Model</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Model/BeamlineObjects/BeamlineObjects.html"><strong aria-hidden="true">2.1.</strong> Beamline Objects</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/OpticalElements.html"><strong aria-hidden="true">2.1.1.</strong> Optical Elements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Cone-Mirror.html"><strong aria-hidden="true">2.1.1.1.</strong> Cone Mirror</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Crystal.html"><strong aria-hidden="true">2.1.1.2.</strong> Crystal</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Cylinder-Mirror.html"><strong aria-hidden="true">2.1.1.3.</strong> Cylinder Mirror</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Ellipsoid-Mirror.html"><strong aria-hidden="true">2.1.1.4.</strong> Ellipsoid Mirror</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Foil.html"><strong aria-hidden="true">2.1.1.5.</strong> Foil</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Image-Plane.html"><strong aria-hidden="true">2.1.1.6.</strong> Image Plane</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Paraboloid-Mirror.html"><strong aria-hidden="true">2.1.1.7.</strong> Paraboloid Mirror</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Plane-Mirror.html"><strong aria-hidden="true">2.1.1.8.</strong> Plane Mirror</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Plane-Grating.html"><strong aria-hidden="true">2.1.1.9.</strong> Plane Grating</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Sphere-Mirror.html"><strong aria-hidden="true">2.1.1.10.</strong> Sphere Mirror</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Sphere-Grating.html"><strong aria-hidden="true">2.1.1.11.</strong> Sphere Grating</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Slit.html"><strong aria-hidden="true">2.1.1.12.</strong> Slit</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Toroid-Mirror.html"><strong aria-hidden="true">2.1.1.13.</strong> Toroid Mirror</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/Toroid-Grating.html"><strong aria-hidden="true">2.1.1.14.</strong> Toroid Grating</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/OpticalElements/RZP.html"><strong aria-hidden="true">2.1.1.15.</strong> Reflection Zone Plate (RZP)</a></li></ol></li><li class="chapter-item "><a href="../Model/BeamlineObjects/LightSources/LightSources.html"><strong aria-hidden="true">2.1.2.</strong> Light Sources</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Model/BeamlineObjects/LightSources/Circle-Source.html"><strong aria-hidden="true">2.1.2.1.</strong> Circle Source</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/LightSources/DipoleSource.html"><strong aria-hidden="true">2.1.2.2.</strong> Dipole Source</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/LightSources/Matrix-Source.html"><strong aria-hidden="true">2.1.2.3.</strong> Matrix Source</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/LightSources/Pixel-Source.html"><strong aria-hidden="true">2.1.2.4.</strong> Pixel Source</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/LightSources/Point-Source.html"><strong aria-hidden="true">2.1.2.5.</strong> Point Source</a></li><li class="chapter-item "><a href="../Model/BeamlineObjects/LightSources/SimpleUndulatorSource.html"><strong aria-hidden="true">2.1.2.6.</strong> Simple Undulator Source</a></li></ol></li><li class="chapter-item "><a href="../Model/BeamlineObjects/BeamlineParameter/Beamline-Parameter.html"><strong aria-hidden="true">2.1.3.</strong> Beamline Parameter</a></li></ol></li><li class="chapter-item "><a href="../Model/User-vs-Model-Parameter.html"><strong aria-hidden="true">2.2.</strong> User vs Model Parameter</a></li><li class="chapter-item "><a href="../Model/Ray-generation.html"><strong aria-hidden="true">2.3.</strong> Ray generation</a></li><li class="chapter-item "><a href="../Model/PRNGs-on-the-GPU.html"><strong aria-hidden="true">2.4.</strong> PRNGs on the GPU</a></li><li class="chapter-item "><a href="../Model/Transformation-between-coordinate-systems.html"><strong aria-hidden="true">2.5.</strong> Transformation between coordinate systems</a></li><li class="chapter-item expanded "><a href="../Model/Quad(ric)-function.html" class="active"><strong aria-hidden="true">2.6.</strong> Quad(ric) Function</a></li><li class="chapter-item "><a href="../Model/Efficiency.html"><strong aria-hidden="true">2.7.</strong> Efficiency calculations</a></li><li class="chapter-item "><a href="../Model/Events.html"><strong aria-hidden="true">2.8.</strong> Events</a></li></ol></li><li class="chapter-item "><a href="../Tools/Tools.html"><strong aria-hidden="true">3.</strong> Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Tools/Code-Coverage.html"><strong aria-hidden="true">3.1.</strong> Code Coverage</a></li><li class="chapter-item "><a href="../Tools/Debugging.html"><strong aria-hidden="true">3.2.</strong> Debugging</a></li><li class="chapter-item "><a href="../Tools/How-to-use-Doxygen.html"><strong aria-hidden="true">3.3.</strong> How to use Doxygen</a></li><li class="chapter-item "><a href="../Tools/How-to-use-our-formatter.html"><strong aria-hidden="true">3.4.</strong> How to use our Formatter</a></li><li class="chapter-item "><a href="../Tools/Testing.html"><strong aria-hidden="true">3.5.</strong> Testing</a></li><li class="chapter-item "><a href="../Tools/RAYX-Profiling.html"><strong aria-hidden="true">3.6.</strong> RAYX Profiling</a></li></ol></li><li class="chapter-item "><a href="../Vulkan/Vulkan.html"><strong aria-hidden="true">4.</strong> Vulkan</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Vulkan/VulkanTracer.html"><strong aria-hidden="true">4.1.</strong> Vulkan Tracer (rayx)</a></li><li class="chapter-item "><a href="../Vulkan/Vulkan-Shader-Split.html"><strong aria-hidden="true">4.2.</strong> Vulkan Shader Split</a></li><li class="chapter-item "><a href="../Vulkan/Vulkan-Beyond.html"><strong aria-hidden="true">4.3.</strong> Vulkan Beyond</a></li></ol></li><li class="chapter-item "><a href="../RAYX-UI/RAYX-UI.html"><strong aria-hidden="true">5.</strong> RAYX-UI</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../RAYX-UI/Triangulation.html"><strong aria-hidden="true">5.1.</strong> Triangulation</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">RAYX Wiki</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="quadric-function"><a class="header" href="#quadric-function">Quad(ric) Function</a></h1>
<p>Function for calculating the intersection of a ray with the surface of an optical element in 3-dimensional space.</p>
<h3 id="input"><a class="header" href="#input">Input:</a></h3>
<ul>
<li>16 parameters \(a_{11}\) to \(a_{44}\) to define the surface in 3D space with the general equation for second order surfaces. Parameter values for specific surfaces can be found in the <a href="https://it-ed-git.basisit.de/RAY/RAY/-/wikis/uploads/bdcf4515e03b2fccf462c5f0d76052c3/Paper_Schaefers_RAY_Springer_2007.pdf">documentation</a>.</li>
<li>\(ray = \begin{bmatrix} x_{S'} \\ y_{S'} \\z_{S'} \\ \end{bmatrix} + t \begin{bmatrix} l_{S'} \\ m_{S'}\\ n_{S'} \\ \end{bmatrix}\)</li>
<li>weight/III (set to 0(python)/-4(Fortran) if ray missed surface, unchanged otherwise)</li>
<li>icurv: determines the sign in the formula for calculating \(t\), if negative first intersection point, if positive second intersection point.</li>
</ul>
<h3 id="output"><a class="header" href="#output">Output:</a></h3>
<ul>
<li>modified ray</li>
<li>normal at intersection point</li>
<li>weight/III</li>
</ul>
<h3 id="calculation-of-intersection-point"><a class="header" href="#calculation-of-intersection-point">Calculation of intersection point</a></h3>
<p>general equation for second order surfaces:
\[F(x,y,z) = a_{11}x^2 + a_{22}y^2 + a_{33}z^2 + 2a_{12}xy + 2a_{13}xz + 2a_{23}yz + 2a_{14}x + 2a_{24}y + 2a_{34}z + a_{44}\]</p>
<p>The intersection is determined by inserting the x, y and z-coordinates of the ray in $F(x,y,z)$ and set to zero: <br>
\[F(x_{S'}+t \cdot l_{S'} ,y_{S'}+t \cdot m_{S'}, z_{S'}+t \cdot n_{S'}) = 0\]</p>
<p>We obtain a quadratic equation of the form \(0 = a \cdot t^2 + b \cdot t + c\) with variable \(t\) and the following coefficients:</p>
<p>\[
\begin{align*}
a &amp;= a_{11}l_{S'}^2 + a_{22}m_{S'}^2 + a_{33}n_{S'}^2 + 2a_{13}l_{S'}n_{S'} + 2a_{12}l_{S'}m_{S'} + 2a_{23}m_{S'}n_{S'} \\
b &amp;= 2a_{11}x_{S'}l_{S'} + 2a_{22}y_{S'}m_{S'} + 2a_{33}z_{S'}n_{S'} \\
&amp;+ 2a_{12}y_{S'}l_{S'} + 2a_{12}x_{S'}m_{S'}
+ 2a_{13}z_{S'}l_{S'} + 2a_{13}x_{S'}n_{S'} \\
&amp;+ 2a_{23}z_{S'}m_{S'} + 2a_{23}y_{S'}n_{S'}
+ 2a_{14}l_{S'} + 2a_{24}m_{S'} + 2a_{34}n_{S'} \\
c &amp;= a_{11}x_{S'}^2 + a_{22}y_{S'}^2 + a_{33}z_{S'}^2 + 2a_{12}x_{S'}y_{S'} + 2a_{13}x_{S'}z_{S'} + 2a_{23}y_{S'}z_{S'} \\
&amp;+ 2a_{14}x_{S'} + 2a_{24}y_{S'} + 2a_{34}z_{S'} + a_{44}
\end{align*}
\]</p>
<p>Since a, b and c can simply be calculated, we could solve the equation directly with  \(t = \frac{-b+ICURV \cdot \sqrt{b^2-4ac}}{2a}\) and use \(t\) to find the intersection point. If ICURV is negative, we get the first intersection point with the object (smaller \(t\)). If ICURV is positive we get the second intersection point from when the ray exits the element (larger \(t\)). Some optimizations are applied to this formula in the code. Depending on the largest component in the direction of the ray, it is normalized in x, y or z direction to simplify the ray equation. Thus, there are three cases.</p>
<h3 id="optimization"><a class="header" href="#optimization">Optimization</a></h3>
<p>Assume \(l_{S'} \geq m_{S'}\) and \(l_{S'} \geq n_{S'}\) (first case). Then, we can divide the direction by \(l_{S'}\), such that it is normalized in x and the y- and z-coordinates are within \([-1,1]\) (I). Moreover, we can translate the origin of the ray along the direction vector towards the origin of the coordinate system until the y-z-plane is hit \((x=0, II)\). Then, we end up with a normalized ray (III), where \(x=t\).</p>
<p>\[
\begin{align*}
ray
&amp;\overset{\text{I}}{=} \begin{bmatrix} x_{S'} \\ y_{S'} \\z_{S'} \\ \end{bmatrix} + t \begin{bmatrix} 1 \\ m_{S'}/l_{S'}\\ n_{S'}/l_{S'} \\ \end{bmatrix} \\
&amp;\overset{\text{II}}{=} \begin{bmatrix} x_{S'}-1\cdot x_{S'} \\ y_{S'} - (m_{S'}/l_{S'}) \cdot y_{S'} \\z_{S'} - (n_{S'}/l_{S'}) \cdot z_{S'} \\ \end{bmatrix} + t \begin{bmatrix} 1 \\ m_{S'}/l_{S'}\\ n_{S'}/l_{S'} \\ \end{bmatrix} \\
&amp;\overset{\text{III}}{=} \begin{bmatrix} 0 \\ y \\ z \end{bmatrix} + t \begin{bmatrix} 1 \\ a_{ml} \\ a_{nl} \\ \end{bmatrix}
\end{align*}
\]</p>
<p>When we plug this parameterization of the ray into \(F(x,y,z)=0\), some terms in a, b and c are removed (see code).</p>
<p>Since every term in b contains the factor 2, the equation for calculating t can be simplified:
\[
t = \frac{-2\frac{b}{2} +ICURV \cdot \sqrt{(2\frac{b}{2})^2 - 4ac}}{2a} \\ = \frac{-2\frac{b}{2} +ICURV \cdot 2\sqrt{(\frac{b}{2})^2 - ac}}{2a} \\ = \frac{-\frac{b}{2} +ICURV \cdot \sqrt{(\frac{b}{2})^2 - ac}}{a}
\]</p>
<p>In the code the factor 2 is left out of the equation for \(b\) from the beginning. Thus, what is called \(b\) in the code is actually \(\frac{b}{2}\).</p>
<p>If the term in the root is negative there is no intersection and weight is set to 0 (or III to -4 in fortran).
Otherwise it is checked whether the factor a is much smaller than \(c\). Then, the divisor is very small or zero which can cause problems with the division. In that case, \(a \cdot t^2\) is removed from the quadratic equation \(a \cdot t^2 + b \cdot t + c\) which thus yields \(t=x=- \frac{c}{b}\) or \(t=x= \frac{c}{2b}\) in the code since the factor \(2\) is excluded from \(b\) (<a href="https://www.cs.uaf.edu/2012/spring/cs481/section/0/lecture/01_26_ray_intersections.html">see also</a> (Ray Quadric Intersection)).
If \(a\) is not much smaller than \(c\), \(t\) is calculated with the simplified equation above. Subsequently, \(t (=x)\) is plugged into the modified ray equation and the intersection point is calculated.</p>
<p>The other two cases for when \(y\) or \(z\) are the largest component of the direction of the ray are similar.</p>
<p>The partial derivatives of \(F(x,y,z)\) form the normal vector \(f_{x,y,z}\) of the surface. Inserting the calculated intersection point into the normal vector yields the normal of the surface at this specific point. The intersection point is set to be the new origin of the ray. The ray direction \((l_{S'},m_{S'},n_{S'})\) remains unchanged.</p>
<h3 id="general-equation-for-second-order-surfaces"><a class="header" href="#general-equation-for-second-order-surfaces">General equation for second order surfaces</a></h3>
<p>The equation can describe the surface of several elements in a similar way as a circle with radius 1 can be described in 2D as \(x^2 + y^2 -1 = 0\). Elements that can be described by this general equation include sphere, ellipsoid, plane, cone, cylinder, paraboloid. These are so called quadric surfaces. Surfaces that cannot be described by any quadratic function include for example the torus.
The equation refers to a right-handed coordinate system with the center of the optical element in the origin. The element's surface is the x-z-plane and the y-axis is the normal vector.</p>
<p>\[
\begin{align*}
F(x,y,z) &amp;= \vec{x}^TA\vec{x} \\
\vec{x} = \begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
A &amp;= \begin{bmatrix} a_{11} &amp; a_{12} &amp; a_{13} &amp; a_{14} \\
a_{21} &amp; a_{22} &amp; a_{23} &amp; a_{24} \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; a_{34} \\
a_{41} &amp; a_{42} &amp; a_{43} &amp; a_{44}
\end{bmatrix} \\
a_{ij} = a_{ji} &amp;\Rightarrow A^T = A
\end{align*}
\]</p>
<p>Literature: <br>
<a href="https://en.wikipedia.org/wiki/Quadric">https://en.wikipedia.org/wiki/Quadric</a> <br>
<a href="https://www.win.tue.nl/~sterk/Bouwkunde/2db60-chap3.pdf">https://www.win.tue.nl/~sterk/Bouwkunde/2db60-chap3.pdf</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../Model/Transformation-between-coordinate-systems.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../Model/Efficiency.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../Model/Transformation-between-coordinate-systems.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../Model/Efficiency.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
